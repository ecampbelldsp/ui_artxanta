<!doctype html>
<html>
<head>
	<link href='https://fonts.googleapis.com/css?family=DM Sans' rel='stylesheet'>
<meta charset="utf-8">
<title>Llave de habitación</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="./css/style.css" rel="stylesheet" type="text/css">
<script src="js/api_request.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/js/bootstrap.min.js" integrity="sha512-1/RvZTcCDEUjY/CypiMz+iqqtaoQfAITmNSJY17Myp4Ms5mdxPS5UV7iOfdZoxcGhzFbOm6sntTKJppjvuhg4g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css" integrity="sha512-SbiR/eusphKoMVVXysTKG/7VseWii+Y3FdHrt0EpKgpToZeemhqHeZeLWLhJutz/2ut2Vw1uQEj2MbRF+TVBUA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  
      <link href = "https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel = "stylesheet">
      <script src = "https://code.jquery.com/jquery-1.10.2.js"></script>
      <script src = "https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
      
     
	
	<script type="text/javascript">
		
	$(window).load(function(){
		$(".fundir").animate({opacity:"1"});
	})
	
	</script>
</head>
<body style="background: #EBEBEB;justify-content:center;display:flex;margin:0px; font-family: 'DM Sans';zoom:150%;">

	
	
	<span style="position: absolute;margin-top: 25vh;margin-left: -100%;z-index:-1" class="dot"></span>

	<div class="fundir" style=" border-radius: 25px;background-color:white;height:800px; width: 500px;margin-top: 18vh;opacity:0;display:block;text-align:center">
		<div style="max-height:70%;overflow:hidden;border-radius: 25px;">
			<img src="image/bienvenida.jpg" style=" border-radius: 25px; z-index: 0;width:100%;height:auto" alt="Hall" width="400" height="450">
		</div>
		<p id="roomID" style="font-family: DM Sans; font-size: 50px; font-weight: bold; color: #6B43F1; margin-top: 10px;padding:30px; opacity: 0;">  <strong>Habitación</strong> <br> </p>

		<p id="cartel_reserva_creada" style="font-family: DM Sans; font-size: 37px; font-weight: bold; color: #6B43F1; margin-top: 10px;padding:30px; position: relative; bottom:150px; opacity: 0;">  <strong>Reserva creada con éxito</strong> <br> </p>
		<p id="localizador" style="font-family: DM Sans; font-size: 45px; font-weight: bold; color: #6B43F1; margin-top: 10px;padding:30px; position: relative; bottom:200px; opacity: 0;">  <strong>Localizador:</strong> <br> </p>

</body> 
	
	<script>
						
				postGuest_json = JSON.parse(localStorage.postGuest);
				console.log(postGuest_json);
				let text = document.getElementById("roomID");
				let cartel = document.getElementById("cartel_reserva_creada");
				let localizador = document.getElementById("localizador");

				console.log("flag_reservation",localStorage.with_reservation_flag);
		
				if (localStorage.with_reservation_flag == "true"){
					
					text.textContent += postGuest_json.roomID;
					text.style.opacity = 1;

					var body = '{"roomName":"","checkIn":"","checkOut":""}';
					var body_json = JSON.parse(body);

					body_json.roomName = postGuest_json.roomID;
					body_json.checkIn = postGuest_json.startDate;
					body_json.checkOut = postGuest_json.endDate;
					body = JSON.stringify(body_json)

					console.log("take_key", body);
					fetchAsync_take_key("http://localhost:5000/tesa/v1.0/checkIn",body);

					
					
				}else{
					cartel.style.opacity = 1;
					localizador.style.opacity = 1;
					localizador.textContent += " " + postGuest_json.reservationID;

				};
		
		
					var body = '{"hotelName": "Hotel Artxanda BILBAO",
								"hotelPhone": "+34628234078",
								"hotelAddress": " Carretera Santo Domingo a, Enekuri Artxanda Errepidea, 3, 48015 Bilbo, Bizkaia",
								"checkIn": "",
								"checkOut": "",
								"roomType": "",
								"reservationID": "",
								"taxRate": "21",
								"roomPrice": "",
								"items": {"Late Check-Out": "15",
													 "Extra clean": "50"}
								}';
		
					var body_json = JSON.parse(body);

					body_json.roomType = postGuest_json.roomType;
					body_json.reservationID = postGuest_json.reservationID;
					body_json.checkIn = postGuest_json.startDate;
					body_json.checkOut = postGuest_json.endDate;
					body_json.roomPrice = postGuest_json.balance;
		
		
		
					body = JSON.stringify(body_json)

					console.log("Print ticket", body);
					fetchAsync_print_ticket("http://localhost:8080/api-hardware/v1/printer/msh245/printTicket ",body);
		
		


//				setTimeout( function(){window.location.href = "/index.html";
//									  },10000 )
		
	</script>
</html>
